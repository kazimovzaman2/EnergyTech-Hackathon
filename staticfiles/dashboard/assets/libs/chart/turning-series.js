$(function () {
  var datasets = {
    baku: {
      label: "Baku",
      data: [
        [1988, 483994],
        [1989, 479060],
        [1990, 457648],
        [1991, 401949],
        [1992, 424705],
        [1993, 402375],
        [1994, 377867],
        [1995, 357382],
        [1996, 337946],
        [1997, 336185],
        [1998, 328611],
        [1999, 329421],
        [2000, 342172],
        [2001, 344932],
        [2002, 387303],
        [2003, 440813],
        [2004, 480451],
        [2005, 504638],
        [2006, 528692],
      ],
    },
    sumqait: {
      label: "Sumqayit",
      data: [
        [1988, 34700],
        [1989, 31100],
        [1990, 26100],
        [1992, 42500],
        [1993, 37600],
        [1994, 36600],
        [1995, 21700],
        [1996, 19200],
        [1997, 21300],
        [1998, 13600],
        [1999, 14000],
        [2000, 19100],
        [2001, 21300],
        [2002, 23600],
        [2003, 25100],
        [2004, 171000],
        [2005, 203000],
        [2006, 218000],
      ],
    },
    gence: {
      label: "Gence",
      data: [
        [1988, 62982],
        [1989, 62027],
        [1990, 60696],
        [1991, 62348],
        [1992, 58560],
        [1993, 56393],
        [1994, 54579],
        [1995, 50818],
        [1996, 50554],
        [1997, 48276],
        [1998, 47691],
        [1999, 47529],
        [2000, 47778],
        [2001, 48760],
        [2002, 50949],
        [2003, 57452],
        [2004, 60234],
        [2005, 60076],
        [2006, 59213],
      ],
    },
    lerik: {
      label: "Lerik",
      data: [
        [1988, 55627],
        [1989, 55475],
        [1990, 58464],
        [1991, 55134],
        [1992, 52436],
        [1993, 47139],
        [1994, 43962],
        [1995, 43238],
        [1996, 42395],
        [1997, 40854],
        [1998, 40993],
        [1999, 41822],
        [2000, 41147],
        [2001, 40474],
        [2002, 40604],
        [2003, 40044],
        [2004, 38816],
        [2005, 38060],
        [2006, 36984],
      ],
    },
    qabala: {
      label: "Qebele",
      data: [
        [1988, 38130],
        [1989, 37190],
        [1990, 37220],
        [1991, 37890],
        [1992, 37200],
        [1993, 37300],
        [1994, 36360],
        [1995, 35980],
        [1996, 36100],
        [1997, 36550],
        [1998, 36950],
        [1999, 36730],
        [2000, 35530],
        [2001, 37740],
        [2002, 37280],
        [2003, 36180],
        [2004, 36380],
        [2005, 34670],
        [2006, 37700],
      ],
    },
    seki: {
      label: "Seki",
      data: [
        [1988, 64020],
        [1989, 64740],
        [1990, 66050],
        [1991, 62090],
        [1992, 60350],
        [1993, 60200],
        [1994, 60000],
        [1995, 60180],
        [1996, 39580],
        [1997, 57800],
        [1998, 59540],
        [1999, 61780],
        [2000, 64110],
        [2001, 59930],
        [2002, 58330],
        [2003, 57910],
        [2004, 54500],
        [2005, 55210],
        [2006, 52710],
      ],
    },
    tovuz: {
      label: "Tovuz",
      data: [
        [1988, 43820],
        [1989, 44980],
        [1990, 45350],
        [1991, 43980],
        [1992, 47660],
        [1993, 44410],
        [1994, 46700],
        [1995, 42170],
        [1996, 42750],
        [1997, 42030],
        [1998, 44820],
        [1999, 45060],
        [2000, 43580],
        [2001, 43850],
        [2002, 52690],
        [2003, 50660],
        [2004, 51940],
        [2005, 48870],
        [2006, 48910],
      ],
    },
  };
  /* var dataSet = [
    {label: "USA", color: "#005CDE" },
    {label: "Russia", color: "#005CDE" },
    { label: "UK", color: "#00A36A" },
    { label: "Germany", color: "#7D0096" },
    { label: "Denmark", color: "#992B00" },
    { label: "Sweden", color: "#DE000F" },
    { label: "Norway", color: "#ED7B00" }    
];*/
  // hard-code color indices to prevent them from shifting as
  // countries are turned on/off
  var i = 0;
  $.each(datasets, function (key, val) {
    val.color = i;
    ++i;
  });

  // insert checkboxes
  var choiceContainer = $("#choices");
  $.each(datasets, function (key, val) {
    choiceContainer.append(
      '<input type="checkbox" name="' +
        key +
        '" checked="checked" id="id' +
        key +
        '">' +
        '<label for="id' +
        key +
        '">' +
        val.label +
        "</label>"
    );
  });
  choiceContainer.find("input").click(plotAccordingToChoices);

  function plotAccordingToChoices() {
    var data = [];

    choiceContainer.find("input:checked").each(function () {
      var key = $(this).attr("name");
      if (key && datasets[key]) data.push(datasets[key]);
    });

    if (data.length > 0)
      $.plot($("#placeholder"), data, {
        yaxis: { min: 0 },
        xaxis: { tickDecimals: 0 },
      });
  }

  plotAccordingToChoices();
});
